<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaRevival - Catalog</title>
    <style>
        body { margin: 0; padding: 0; background: #000 url('https://www.themebeta.com/thumbnail/728/1113207/files/chrome/images/201607/08/a7e9a6aa6caf76e019e27cacd48ef143.webp') fixed center/cover; color: white; font-family: Arial, sans-serif; }
        .topbar-black { background: #1a1a1a; height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; position: fixed; top: 0; left: 0; right: 0; z-index: 100; border-bottom: 1px solid #333; }
        .nav-links a { color: white; text-decoration: none; margin: 0 15px; font-size: 18px; }
        .nav-links a:hover { text-decoration: underline; }
        .search-bar { background: #333; border: none; padding: 10px; border-radius: 20px; width: 300px; color: white; }
        .top-right-icons { display: flex; align-items: center; gap: 20px; font-size: 24px; }
        .currency { display: flex; align-items: center; gap: 8px; font-weight: bold; font-size: 18px; }
        .currency img { width: 28px; height: 28px; }
        .robux-amount { color: #00FF00; }
        .tix-amount { color: #FFD700; }
        .notification-bell img { width: 28px; height: 28px; vertical-align: middle; }
        .notification-bell { position: relative; cursor: pointer; }
        .settings-dropdown {
            position: absolute;
            top: 60px;
            right: 20px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 10px 0;
            min-width: 140px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            display: none;
            z-index: 200;
        }
        .settings-dropdown button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            background: none;
            border: none;
            color: white;
            text-align: left;
            font-size: 16px;
            cursor: pointer;
        }
        .settings-dropdown button:hover {
            background: rgba(255,255,255,0.1);
        }
        .orange-banner { background: #FFA500; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 18px; position: fixed; top: 60px; left: 220px; right: 0; z-index: 99; }
        .sidebar { position: fixed; left: 0; top: 60px; bottom: 0; width: 220px; background: #1a1a1a; padding: 20px 0; overflow-y: auto; }
        .sidebar a { display: block; padding: 15px 20px; color: #ccc; text-decoration: none; font-size: 18px; }
        .sidebar a:hover { background: rgba(255,165,0,0.2); }
        .sidebar .admin-link { display: none; color: #FF0000; font-weight: bold; }
        .sidebar .upgrade { background: #000; color: white; margin: 20px; padding: 15px; text-align: center; border: 2px solid white; font-weight: bold; font-size: 18px; }
        /* Main content scrollable area */
        .main {
            margin-left: 220px;
            margin-top: 100px;
            padding: 20px;
            height: calc(100vh - 100px);
            overflow-y: auto;
            box-sizing: border-box;
        }
        .catalog-header { font-size: 36px; font-weight: bold; color: #fff; margin-bottom: 15px; padding-left: 5px; }
        .catalog-top {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 20px;
        }
        .catalog-sidebar {
            width: 200px;
            background: #222;
            padding: 15px;
            border-radius: 6px;
        }
        .catalog-sidebar h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: #ccc;
        }
        .catalog-sidebar a {
            display: block;
            color: #66ccff;
            text-decoration: none;
            padding: 4px 0;
        }
        .catalog-sidebar a:hover { text-decoration: underline; }
        .top-filters {
            flex-grow: 1;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 20px;
            background: #222;
            padding: 10px 15px;
            border-radius: 6px;
        }
        .top-filters select {
            background: #333;
            color: white;
            border: 1px solid #444;
            padding: 8px;
            border-radius: 4px;
        }
        .items-section h2 {
            font-size: 26px;
            margin: 30px 0 15px 0;
            color: #fff;
        }
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }
        .item {
            position: relative;
            transition: transform 0.15s ease;
            cursor: pointer;
        }
        .item:hover {
            transform: translateY(-6px);
        }
        .item-box {
            background: #222;
            border: 1px solid #444;
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }
        .item-image {
            width: 100%;
            height: 140px;
            object-fit: cover;
            display: block;
        }
        .item-name {
            padding: 8px;
            text-align: center;
            font-size: 14px;
            color: #fff;
            background: #222;
        }
        .item-price {
            text-align: center;
            margin-top: 8px;
            font-size: 18px;
            font-weight: bold;
        }
        .price-robux { color: #00ff00; }
        .price-tix { color: #FFD700; }
        .offsale {
            color: #ff6666 !important;
        }
        .new-ribbon {
            position: absolute;
            top: 4px;
            right: -8px;
            background: #ff0000;
            color: white;
            font-size: 12px;
            font-weight: bold;
            padding: 3px 10px;
            border-radius: 4px;
            transform: rotate(20deg);
            z-index: 2;
        }
        /* Item Details Modal */
        #itemModal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: #111;
            border: 1px solid #444;
            border-radius: 12px;
            width: 600px;
            max-width: 90%;
            padding: 30px;
            color: white;
            position: relative;
        }
        .modal-close {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 30px;
            cursor: pointer;
            color: #ccc;
        }
        .modal-close:hover { color: white; }
        .modal-title {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .modal-creator {
            color: #aaa;
            margin-bottom: 20px;
            font-size: 18px;
        }
        .modal-image {
            width: 300px;
            height: 300px;
            object-fit: contain;
            background: #222;
            border-radius: 10px;
            margin: 0 auto 20px;
            display: block;
        }
        .modal-description {
            margin-bottom: 20px;
            font-size: 18px;
        }
        .modal-buy {
            text-align: right;
        }
        .modal-price {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .buy-button {
            background: #00cc00;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
        }
        .buy-button:hover {
            background: #00ff00;
        }
        .modal-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            color: #aaa;
        }
        .favorite-btn {
            color: #FFD700;
            cursor: pointer;
        }
        /* Custom scrollbar styling */
        .main::-webkit-scrollbar {
            width: 12px;
        }
        .main::-webkit-scrollbar-track {
            background: #111;
        }
        .main::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
        }
        .main::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .sidebar::-webkit-scrollbar {
            width: 8px;
        }
        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }
        .sidebar::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Black Top Bar -->
    <div class="topbar-black">
        <div class="nav-links">
            <a href="#">Games</a>
            <a href="catalog.html">Catalog</a>
            <a href="#">Create</a>
            <a href="#">Download</a>
        </div>
        <input type="text" class="search-bar" placeholder="Search">
        <div class="top-right-icons">
            <span id="usernameDisplay">Guest</span>
            <div class="currency">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Robux_2019_Logo_gold.svg/800px-Robux_2019_Logo_gold.svg.png" alt="Robux">
                <span id="robuxAmount" class="robux-amount">0</span>
            </div>
            <div class="currency">
                <img src="https://tr.rbxcdn.com/e0d943e9fdaa48c32c5f29d69e66166c/420/420/Image/Png" alt="Tix">
                <span id="tixAmount" class="tix-amount">0</span>
            </div>
            <div class="notification-bell" id="settingsIcon">
                <img src="https://www.iconpacks.net/icons/2/free-settings-icon-3110-thumb.png" alt="Settings">
            </div>
        </div>
    </div>
    <!-- Settings Dropdown -->
    <div class="settings-dropdown" id="settingsDropdown">
        <button onclick="signOut()">Sign out</button>
        <button onclick="goToSettings()">Settings</button>
    </div>
    <!-- Orange Banner -->
    <div class="orange-banner">
        Hey, hey you! Copy the link to join the discord server: https://discord.gg/mrnwrdXgSa
    </div>
    <!-- Sidebar -->
    <div class="sidebar">
        <a href="home.html">Home</a>
        <a href="#">Profile</a>
        <a href="#">Messages</a>
        <a href="#">Friends</a>
        <a href="#">Avatar</a>
        <a href="#">Inventory</a>
        <a href="#">Trade</a>
        <a href="#">Groups</a>
        <a href="#">Forums</a>
        <a href="#">Redeem</a>
        <a href="admin.html" class="admin-link">ADMIN</a>
        <div class="upgrade">Upgrade Now</div>
    </div>
    <!-- Catalog Content -->
    <div class="main">
        <h1 class="catalog-header">Catalog</h1>
        <div class="catalog-top">
            <div class="catalog-sidebar">
                <h3>Browse by Category</h3>
                <a href="#">Featured</a>
                <a href="#">Collectibles</a>
                <a href="#">All Categories</a>
                <a href="#">Clothing</a>
                <a href="#">Body Parts</a>
                <a href="#">Gear</a>
                <a href="#">Animations</a>
            </div>
            <div class="top-filters">
                <div>
                    <strong>Sort By:</strong>
                    <select>
                        <option>Relevance</option>
                        <option>Most Popular</option>
                        <option>Price (Low to High)</option>
                        <option>Price (High to Low)</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="items-section">
            <h2>Featured Items on NovaRevival</h2>
            <div class="items-grid" id="catalogGrid">
                <!-- Items loaded dynamically -->
            </div>
        </div>
    </div>
    <!-- Item Details Modal -->
    <div id="itemModal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal()">×</div>
            <h1 class="modal-title" id="modalTitle"></h1>
            <div class="modal-creator" id="modalCreator"></div>
            <img id="modalImage" class="modal-image" src="" alt="">
            <div class="modal-description" id="modalDescription">No description provided.</div>
            <div class="modal-buy">
                <div class="modal-price" id="modalPrice"></div>
                <button class="buy-button" id="buyButton" onclick="buyItem()">Buy with R$</button>
            </div>
            <div class="modal-footer">
                <div>Genres: All</div>
                <div class="favorite-btn">★ Favorite</div>
            </div>
        </div>
    </div>
    <script>
        // Existing functions...
        document.getElementById('settingsIcon').addEventListener('click', function(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('settingsDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        });
        document.addEventListener('click', function() {
            document.getElementById('settingsDropdown').style.display = 'none';
        });
        function signOut() {
            localStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        }
        function goToSettings() {
            alert('Settings page coming soon!');
        }
        const currentUser = localStorage.getItem('currentUser');
        if (!currentUser) {
            alert('Not logged in! Redirecting to login...');
            window.location.href = 'login.html';
        } else {
            document.getElementById('usernameDisplay').innerText = currentUser;
            const userData = JSON.parse(localStorage.getItem(currentUser) || '{}');
            const robux = userData.robux || 0;
            const tix = userData.tix || 0;
            function abbreviateNumber(num) {
                if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
                if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
                if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
                return num.toString();
            }
            document.getElementById('robuxAmount').innerText = abbreviateNumber(robux);
            document.getElementById('tixAmount').innerText = abbreviateNumber(tix);
        }
        const admins = ['TestUser', 'tinypuurs', 'NovaRevival'];
        if (admins.includes(currentUser)) {
            document.querySelector('.admin-link').style.display = 'block';
        }
        // Dynamic Catalog Loading
        let currentItem = null; // For buying
        function loadCatalog() {
            const grid = document.getElementById('catalogGrid');
            grid.innerHTML = '';
            const catalog = JSON.parse(localStorage.getItem('catalog') || '[]');
            if (catalog.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #aaa; font-size: 20px;">No items in catalog yet.</p>';
                return;
            }
            catalog.sort((a, b) => b.id - a.id);
            catalog.forEach(item => {
                if (!item.onSale) return;
                const div = document.createElement('div');
                div.className = 'item';
                div.onclick = () => openModal(item);
                let priceHTML = '';
                const hasRobux = item.robuxPrice > 0;
                const hasTix = item.tixPrice > 0;
                if (hasRobux && hasTix) {
                    priceHTML = `<div class="item-price price-robux">R$${item.robuxPrice}</div>
                                 <div class="item-price price-tix">${item.tixPrice} Tix</div>`;
                } else if (hasRobux) {
                    priceHTML = `<div class="item-price price-robux">R$${item.robuxPrice}</div>`;
                } else if (hasTix) {
                    priceHTML = `<div class="item-price price-tix">${item.tixPrice} Tix</div>`;
                } else {
                    priceHTML = `<div class="item-price">Free</div>`;
                }
                div.innerHTML = `
                    ${item.isNew ? '<div class="new-ribbon">NEW</div>' : ''}
                    <div class="item-box">
                        <img src="${item.image}" alt="${item.name}" class="item-image">
                        <div class="item-name">${item.name}</div>
                    </div>
                    ${priceHTML}
                `;
                grid.appendChild(div);
            });
        }
        function openModal(item) {
            currentItem = item;
            document.getElementById('modalTitle').innerText = item.name;
            document.getElementById('modalImage').src = item.image;

            // Fix creator display
            const creatorText = item.creator ? `By: ${item.creator}` : 'By: Unknown';
            const verifiedMark = item.verified ? ' ✔️' : '';
            document.getElementById('modalCreator').innerText = creatorText + verifiedMark;

            // Fix description
            document.getElementById('modalDescription').innerText = item.description || 'No description provided.';

            let priceText = '';
            if (item.robuxPrice > 0) priceText += `R$${item.robuxPrice}`;
            if (item.tixPrice > 0) priceText += priceText ? ` | ${item.tixPrice} Tix` : `${item.tixPrice} Tix`;
            if (priceText === '') priceText = 'Free';
            document.getElementById('modalPrice').innerText = `Price: ${priceText}`;
            document.getElementById('buyButton').innerText = item.robuxPrice > 0 ? 'Buy with R$' : (item.tixPrice > 0 ? 'Buy with Tix' : 'Get for Free');

            document.getElementById('itemModal').style.display = 'flex';
        }
        function closeModal() {
            document.getElementById('itemModal').style.display = 'none';
            currentItem = null;
        }
        function buyItem() {
            if (!currentItem) return;
            let userData = JSON.parse(localStorage.getItem(currentUser) || '{}');
            const robuxCost = currentItem.robuxPrice || 0;
            const tixCost = currentItem.tixPrice || 0;
            if (userData.robux < robuxCost || userData.tix < tixCost) {
                alert('Not enough currency!');
                return;
            }
            userData.robux = (userData.robux || 0) - robuxCost;
            userData.tix = (userData.tix || 0) - tixCost;
            if (!userData.inventory) userData.inventory = [];
            userData.inventory.push(currentItem.id);
            localStorage.setItem(currentUser, JSON.stringify(userData));
            alert(`You bought ${currentItem.name}!`);
            document.getElementById('robuxAmount').innerText = abbreviateNumber(userData.robux);
            document.getElementById('tixAmount').innerText = abbreviateNumber(userData.tix);
            closeModal();
        }
        window.addEventListener('load', loadCatalog);
        window.addEventListener('storage', loadCatalog);
        document.getElementById('itemModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
    </script>
</body>
</html>